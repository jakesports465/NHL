<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Sign up · NHL Puck'Em</title>
<link rel="icon" href="data:,">
<style>
  :root{ --bg:#0b0d10; --card:#12161b; --muted:#8ea0b3; --text:#e8eef4; --br:#1b232d }
  html,body{margin:0;background:var(--bg);color:var(--text);font:15px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
  .wrap{max-width:440px;margin:48px auto;padding:0 16px}
  .card{background:var(--card);border:1px solid var(--br);border-radius:14px;padding:16px}
  h1{margin:0 0 10px 0;font-size:22px}
  .field{display:flex;flex-direction:column;gap:8px;margin-top:10px}
  input{background:#0b1117;border:1px solid #1b2633;border-radius:10px;color:var(--text);padding:12px;font-size:16px}
  .btn{background:#14202b;border:1px solid #243241;color:var(--text);padding:12px 14px;border-radius:10px;cursor:pointer;font-size:15px;min-height:44px;margin-top:12px}
  .small{color:var(--muted);font-size:13px}
  a{color:#b8cff0}
  .msg{margin-top:10px}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h1>Create your account</h1>
    <div class="small">Already have one? <a href="index.html">Log in</a></div>

    <div class="field">
      <input id="email" type="email" placeholder="email@example.com" autocomplete="email" required>
      <input id="pass"  type="password" placeholder="Password (min 6)" autocomplete="new-password" required>
      <input id="pass2" type="password" placeholder="Confirm password" autocomplete="new-password" required>
      <button id="create" class="btn">Sign up</button>
      <div id="msg" class="msg small"></div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  const SUPA_URL  = 'https://acmqdokxwnkkjmfgfyhh.supabase.co';
  const SUPA_ANON = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFjbXFkb2t4d25ra2ptZmdmeWhoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgzMDY4MDAsImV4cCI6MjA3Mzg4MjgwMH0.cHgUbNwXQvWZJnQNetxO5kr0kVPIR2XO9vVkIJZj_-w';
  const supa = supabase.createClient(SUPA_URL, SUPA_ANON, {
    auth: { persistSession: true, detectSessionInUrl: true, flowType: 'pkce' }
  });

  const $ = id => document.getElementById(id);
  $('create').addEventListener('click', async () => {
    const e = $('email').value.trim();
    const p = $('pass').value;
    const p2 = $('pass2').value;
    if (!e || !p) return $('msg').textContent = 'Enter email and password.';
    if (p !== p2) return $('msg').textContent = 'Passwords do not match.';

    $('msg').textContent = 'Creating…';
    const { error } = await supa.auth.signUp({ email: e, password: p });
    if (error) {
      $('msg').textContent = error.message;
      return;
    }
    // If email confirmations are ON, user must verify; otherwise they’re signed in.
    $('msg').textContent = 'Account created. Redirecting…';
    // Go back to app
    location.href = 'index.html';
  });
</script>
</body>
</html>
